<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.3/leaflet.css" />
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script src="http://code.highcharts.com/highcharts.js"></script>
    <script src="http://code.highcharts.com/modules/exporting.js"></script>
    <script src="js/crash_geojson.js"></script>
    <title></title>
</head>
<style type="text/css">
    .story-header {
        padding-bottom: 0;
        border-bottom: none;
        margin-bottom: 0;
        position: relative;
        font-family: Verdana, sans-serif;
        text-align:center;
    }
    body{
        font-family: nyt-franklin, Arial, sans-serif;
        font-style: normal;
        font-variant: normal;
        font-weight: normal;
        font-stretch: normal;
        line-height: 1.3;
        text-align:justify;
    }
    .interactive-headline{
        margin-bottom: 50px !important;
        font: 300 38px/1.15 nyt-franklin, Arial, sans-serif !important;
        font-family: nyt-franklin, Arial, sans-serif;
        font-size: 38px;
        font-style: normal;
        font-variant: normal;
        font-weight: 300;
        font-stretch: normal;
        line-height: 1.15;
    }
</style>
<body>
<header class="story-header interactive-header">
    <div>
        <h1 class="interactive-headline">Mapping Pedestrian Activities & Safety in City of Melbourne</h1>
    </div>
</header>

   <div id="wrapper">
       <div class=container style="display: flex; width: 1250px;">
           <div class="left-side" style="width: 600px; height: 400px; margin: 0 auto;">
                <div id="bar-chart" style="width: 600px; height: 250px; margin: 0 auto"></div>
               <div><p>This is text This is text This is text This is text This is text This is text This is text This is text This is text This is text
        This is text This is text This is text This is text This is text This is text This is text This is text This is text
        This is text This is text This is text This is text This is text </p></div>
           </div>

           <div class="right-side" style="width: 600px; height: 400px; margin: 0 auto;">
               <div id="map" style="width: 600px; height: 400px"></div>
           </div>
       </div>
        <div style="width: 1220px; margin: 0 auto;"><p>This is text This is text This is text This is text This is text This is text This is text This is text This is text This is text
        This is text This is text This is text This is text This is text This is text This is text This is text This is text
        This is text This is text This is text This is text This is text This is text This is text This is text This is text This is text This is text This is text This is text This is text This is text
        This is text This is text This is text This is text This is text This is text This is text This is text This is text
        This is text This is text This is text This is text This is textThis is text This is text This is text This is text This is text This is text This is text This is text This is text This is text
        This is text This is text This is text This is text This is text This is text This is text This is text This is text
        This is text This is text This is text This is text This is textThis is text This is text This is text This is text This is text This is text This is text This is text This is text This is text
        This is text This is text This is text This is text This is text This is text This is text This is text This is text
        This is text This is text This is text This is text This is text</p></div>
       <div class=container style="display: flex; width: 1250px;">
           <div class="left-side" style="width: 600px; height: 400px; margin: 0 auto;">
                <div id="sensor-chart" style="width: 600px; height: 350px; margin: 0 auto"></div>
           </div>

           <div class="right-side" style="width: 600px; height: 400px; margin: 0 auto;">
               <div id="sensor-map" style="width: 600px; height: 400px"></div>
           </div>
       </div>
        <div style="width: 1220px; margin: 0 auto;"><p>This is text This is text This is text This is text This is text This is text This is text This is text This is text This is text
        This is text This is text This is text This is text This is text This is text This is text This is text This is text
        This is text This is text This is text This is text This is text This is text This is text This is text This is text This is text This is text This is text This is text This is text This is text
        This is text This is text This is text This is text This is text This is text This is text This is text This is text
        This is text This is text This is text This is text This is textThis is text This is text This is text This is text This is text This is text This is text This is text This is text This is text
        This is text This is text This is text This is text This is text This is text This is text This is text This is text
        This is text This is text This is text This is text This is textThis is text This is text This is text This is text This is text This is text This is text This is text This is text This is text
        This is text This is text This is text This is text This is text This is text This is text This is text This is text
        This is text This is text This is text This is text This is text</p></div>
   </div>


   <script src="http://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.3/leaflet.js"></script>
   <script src='https://api.tiles.mapbox.com/mapbox.js/v1.6.4/mapbox.js'></script>
   <link href='https://api.tiles.mapbox.com/mapbox.js/v1.6.4/mapbox.css' rel='stylesheet' />
   <script src="js/buffer.js"></script>
   <script src="js/create_map.js"></script>

    <script src="json/ped_sensor.json"></script>
    <script src="js/sensor_geojson.js"></script>
    <script src="js/create_sensor_map.js"></script>
<script>
$(function () {
    var options = {
        credits: {
            enabled: false
        },
        chart: {
            type: 'column'
        },
        title: {
            text: 'Melbourne Pedestrian Crash Count 2009-2013'
        },
        subtitle: {
            text: 'Source: <a href="http://www.data.vic.gov.au ">Victorian Government Data Directory</a>'
        },
        xAxis: {
            type: 'category',
            crosshair: true,
            labels: {
                rotation: 0,
                style: {
                    fontSize: '12px',
                    fontFamily: 'Verdana, sans-serif'
                }
            }
        },
        yAxis: [{
            min: 0,
            title: {
                text: 'Pedestrian Crash Count',
                style: {
                    color: Highcharts.getOptions().colors[0]
                }
            },
            labels: {
                format: '{value}',
                style: {
                    color: Highcharts.getOptions().colors[0]
                }
            }
        },{ // Secondary yAxis
            title: {
                text: 'Pedestrian Count',
                style: {
                    color: Highcharts.getOptions().colors[1]
                }
            },
            labels: {
                format: '{value}',
                formatter: function () {
                    return Highcharts.numberFormat(this.value,0);
                },
                style: {
                    color: Highcharts.getOptions().colors[1]
                }
            },
            min: 0,
            opposite: true
        }],
        legend: {
            enabled: false
        },
        tooltip: {
            shared:true,
            headerFormat: ''
//            formatter: function () {
////                console.log(this);
//                return '<strong>'+this.x+'<br/></strong><strong>Pedestrian Crash Count: '+this.y+'</strong>';
//            }
//            pointFormat: '<strong>Pedestrian Crash Count: {point.y} </strong>'
        },
        series: [{
            name: 'Pedestrian crash count',
            data: [],
            dataLabels: {
                allowOverlap: true,
                enabled: true,
                rotation: 0,
                color: '#FFFFFF',
                align: 'center',
                format: '{point.y}',
                y: 18, // 5 pixels down from the top
                style: {
                    fontSize: '10px',
                    fontFamily: 'Verdana, sans-serif'
                }
            }
        }],
        plotOptions: {
            series: {
                marker: {
                    enabled: false
                },
                pointPadding: 0,
                groupPadding: 0.1,
                point: {
                    events: {
                        mouseOver: function () {
                            $(this.series.chart.xAxis[0].labelGroup.element.childNodes[this.x]).css({
                                    'fill': '#7cb5ec',
                                    'font-weight': 'bold',
                                    'font-size': '14px'
                            });
                            //this.x start from 0-23 (24 hours)
                           // console.log(this.x);

                            showCurrentCrash(layerArray,this.x);

                            if(this.x == 0)
                            {
                                map.addLayer(buffer0);map.removeLayer(buffer1);map.removeLayer(buffer2);map.removeLayer(buffer3);
                                map.removeLayer(buffer4);map.removeLayer(buffer5);map.removeLayer(buffer6);map.removeLayer(buffer7);map.removeLayer(buffer8);map.removeLayer(buffer9);map.removeLayer(buffer10);map.removeLayer(buffer11);map.removeLayer(buffer12);map.removeLayer(buffer13);map.removeLayer(buffer14);map.removeLayer(buffer15);map.removeLayer(buffer16);
                                map.removeLayer(buffer17);map.removeLayer(buffer18);map.removeLayer(buffer19);map.removeLayer(buffer20);
                                map.removeLayer(buffer21);map.removeLayer(buffer22);map.removeLayer(buffer23);
                            }
                            else if(this.x == 1)
                            {
                                map.addLayer(buffer1);map.removeLayer(buffer0);map.removeLayer(buffer2);map.removeLayer(buffer3);
                                map.removeLayer(buffer4);map.removeLayer(buffer5);map.removeLayer(buffer6);map.removeLayer(buffer7);map.removeLayer(buffer8);map.removeLayer(buffer9);map.removeLayer(buffer10);map.removeLayer(buffer11);map.removeLayer(buffer12);map.removeLayer(buffer13);map.removeLayer(buffer14);map.removeLayer(buffer15);map.removeLayer(buffer16);
                                map.removeLayer(buffer17);map.removeLayer(buffer18);map.removeLayer(buffer19);map.removeLayer(buffer20);
                                map.removeLayer(buffer21);map.removeLayer(buffer22);map.removeLayer(buffer23);
                            }
                            else if(this.x ==2)
                            {
                                map.addLayer(buffer2);map.removeLayer(buffer0);map.removeLayer(buffer1);map.removeLayer(buffer3);
                                map.removeLayer(buffer4);map.removeLayer(buffer5);map.removeLayer(buffer6);map.removeLayer(buffer7);map.removeLayer(buffer8);map.removeLayer(buffer9);map.removeLayer(buffer10);map.removeLayer(buffer11);map.removeLayer(buffer12);map.removeLayer(buffer13);map.removeLayer(buffer14);map.removeLayer(buffer15);map.removeLayer(buffer16);
                                map.removeLayer(buffer17);map.removeLayer(buffer18);map.removeLayer(buffer19);map.removeLayer(buffer20);
                                map.removeLayer(buffer21);map.removeLayer(buffer22);map.removeLayer(buffer23);
                            }
                            else if(this.x == 3)
                            {
                                map.addLayer(buffer3);map.removeLayer(buffer0);map.removeLayer(buffer1);map.removeLayer(buffer2);
                                map.removeLayer(buffer4);map.removeLayer(buffer5);map.removeLayer(buffer6);map.removeLayer(buffer7);map.removeLayer(buffer8);map.removeLayer(buffer9);map.removeLayer(buffer10);map.removeLayer(buffer11);map.removeLayer(buffer12);map.removeLayer(buffer13);map.removeLayer(buffer14);map.removeLayer(buffer15);map.removeLayer(buffer16);
                                map.removeLayer(buffer17);map.removeLayer(buffer18);map.removeLayer(buffer19);map.removeLayer(buffer20);
                                map.removeLayer(buffer21);map.removeLayer(buffer22);map.removeLayer(buffer23);
                            }
                            else if(this.x ==4)
                            {
                                map.addLayer(buffer4);map.removeLayer(buffer0);map.removeLayer(buffer1);map.removeLayer(buffer2);
                                map.removeLayer(buffer3);map.removeLayer(buffer5);map.removeLayer(buffer6);map.removeLayer(buffer7);map.removeLayer(buffer8);map.removeLayer(buffer9);map.removeLayer(buffer10);map.removeLayer(buffer11);map.removeLayer(buffer12);map.removeLayer(buffer13);map.removeLayer(buffer14);map.removeLayer(buffer15);map.removeLayer(buffer16);
                                map.removeLayer(buffer17);map.removeLayer(buffer18);map.removeLayer(buffer19);map.removeLayer(buffer20);
                                map.removeLayer(buffer21);map.removeLayer(buffer22);map.removeLayer(buffer23);
                            }
                            else if(this.x == 5)
                            {
                                map.addLayer(buffer5);map.removeLayer(buffer0);map.removeLayer(buffer1);map.removeLayer(buffer2);
                                map.removeLayer(buffer3);map.removeLayer(buffer4);map.removeLayer(buffer6);map.removeLayer(buffer7);map.removeLayer(buffer8);map.removeLayer(buffer9);map.removeLayer(buffer10);map.removeLayer(buffer11);map.removeLayer(buffer12);map.removeLayer(buffer13);map.removeLayer(buffer14);map.removeLayer(buffer15);map.removeLayer(buffer16);
                                map.removeLayer(buffer17);map.removeLayer(buffer18);map.removeLayer(buffer19);map.removeLayer(buffer20);
                                map.removeLayer(buffer21);map.removeLayer(buffer22);map.removeLayer(buffer23);
                            }
                            else if(this.x == 6)
                            {
                                map.addLayer(buffer6);map.removeLayer(buffer0);map.removeLayer(buffer1);map.removeLayer(buffer2);
                                map.removeLayer(buffer3);map.removeLayer(buffer4);map.removeLayer(buffer5);map.removeLayer(buffer7);map.removeLayer(buffer8);map.removeLayer(buffer9);map.removeLayer(buffer10);map.removeLayer(buffer11);map.removeLayer(buffer12);map.removeLayer(buffer13);map.removeLayer(buffer14);map.removeLayer(buffer15);map.removeLayer(buffer16);
                                map.removeLayer(buffer17);map.removeLayer(buffer18);map.removeLayer(buffer19);map.removeLayer(buffer20);
                                map.removeLayer(buffer21);map.removeLayer(buffer22);map.removeLayer(buffer23);
                            }
                            else if(this.x == 7)
                            {
                                map.addLayer(buffer7);map.removeLayer(buffer0);map.removeLayer(buffer1);map.removeLayer(buffer2);
                                map.removeLayer(buffer3);map.removeLayer(buffer4);map.removeLayer(buffer5);map.removeLayer(buffer6);map.removeLayer(buffer8);map.removeLayer(buffer9);map.removeLayer(buffer10);map.removeLayer(buffer11);map.removeLayer(buffer12);map.removeLayer(buffer13);map.removeLayer(buffer14);map.removeLayer(buffer15);map.removeLayer(buffer16);
                                map.removeLayer(buffer17);map.removeLayer(buffer18);map.removeLayer(buffer19);map.removeLayer(buffer20);
                                map.removeLayer(buffer21);map.removeLayer(buffer22);map.removeLayer(buffer23);
                            }
                            else if(this.x == 8)
                            {
                                map.addLayer(buffer8);map.removeLayer(buffer0);map.removeLayer(buffer1);map.removeLayer(buffer2);
                                map.removeLayer(buffer3);map.removeLayer(buffer4);map.removeLayer(buffer5);map.removeLayer(buffer6);map.removeLayer(buffer7);map.removeLayer(buffer9);map.removeLayer(buffer10);map.removeLayer(buffer11);map.removeLayer(buffer12);map.removeLayer(buffer13);map.removeLayer(buffer14);map.removeLayer(buffer15);map.removeLayer(buffer16);
                                map.removeLayer(buffer17);map.removeLayer(buffer18);map.removeLayer(buffer19);map.removeLayer(buffer20);
                                map.removeLayer(buffer21);map.removeLayer(buffer22);map.removeLayer(buffer23);
                            }
                            else if(this.x == 9)
                            {
                                map.addLayer(buffer9);map.removeLayer(buffer0);map.removeLayer(buffer1);map.removeLayer(buffer2);
                                map.removeLayer(buffer3);map.removeLayer(buffer4);map.removeLayer(buffer5);map.removeLayer(buffer6);map.removeLayer(buffer7);map.removeLayer(buffer8);map.removeLayer(buffer10);map.removeLayer(buffer11);map.removeLayer(buffer12);map.removeLayer(buffer13);map.removeLayer(buffer14);map.removeLayer(buffer15);map.removeLayer(buffer16);
                                map.removeLayer(buffer17);map.removeLayer(buffer18);map.removeLayer(buffer19);map.removeLayer(buffer20);
                                map.removeLayer(buffer21);map.removeLayer(buffer22);map.removeLayer(buffer23);
                            }
                            else if(this.x == 10)
                            {
                                map.addLayer(buffer10);map.removeLayer(buffer0);map.removeLayer(buffer1);map.removeLayer(buffer2);
                                map.removeLayer(buffer3);map.removeLayer(buffer4);map.removeLayer(buffer5);map.removeLayer(buffer6);map.removeLayer(buffer7);map.removeLayer(buffer8);map.removeLayer(buffer9);map.removeLayer(buffer11);map.removeLayer(buffer12);map.removeLayer(buffer13);map.removeLayer(buffer14);map.removeLayer(buffer15);map.removeLayer(buffer16);
                                map.removeLayer(buffer17);map.removeLayer(buffer18);map.removeLayer(buffer19);map.removeLayer(buffer20);
                                map.removeLayer(buffer21);map.removeLayer(buffer22);map.removeLayer(buffer23);
                            }
                            else if(this.x == 11)
                            {
                                map.addLayer(buffer11);map.removeLayer(buffer0);map.removeLayer(buffer1);map.removeLayer(buffer2);
                                map.removeLayer(buffer3);map.removeLayer(buffer4);map.removeLayer(buffer5);map.removeLayer(buffer6);map.removeLayer(buffer7);map.removeLayer(buffer8);map.removeLayer(buffer9);map.removeLayer(buffer10);map.removeLayer(buffer12);map.removeLayer(buffer13);map.removeLayer(buffer14);map.removeLayer(buffer15);map.removeLayer(buffer16);
                                map.removeLayer(buffer17);map.removeLayer(buffer18);map.removeLayer(buffer19);map.removeLayer(buffer20);
                                map.removeLayer(buffer21);map.removeLayer(buffer22);map.removeLayer(buffer23);
                            }
                            else if(this.x == 12)
                            {
                                map.addLayer(buffer12);map.removeLayer(buffer0);map.removeLayer(buffer1);map.removeLayer(buffer2);
                                map.removeLayer(buffer3);map.removeLayer(buffer4);map.removeLayer(buffer5);map.removeLayer(buffer6);map.removeLayer(buffer7);map.removeLayer(buffer8);map.removeLayer(buffer9);map.removeLayer(buffer10);map.removeLayer(buffer11);map.removeLayer(buffer13);map.removeLayer(buffer14);map.removeLayer(buffer15);map.removeLayer(buffer16);
                                map.removeLayer(buffer17);map.removeLayer(buffer18);map.removeLayer(buffer19);map.removeLayer(buffer20);
                                map.removeLayer(buffer21);map.removeLayer(buffer22);map.removeLayer(buffer23);
                            }
                            else if(this.x == 13)
                            {
                                map.addLayer(buffer13);map.removeLayer(buffer0);map.removeLayer(buffer1);map.removeLayer(buffer2);
                                map.removeLayer(buffer3);map.removeLayer(buffer4);map.removeLayer(buffer5);map.removeLayer(buffer6);map.removeLayer(buffer7);map.removeLayer(buffer8);map.removeLayer(buffer9);map.removeLayer(buffer10);map.removeLayer(buffer11);map.removeLayer(buffer12);map.removeLayer(buffer14);map.removeLayer(buffer15);map.removeLayer(buffer16);
                                map.removeLayer(buffer17);map.removeLayer(buffer18);map.removeLayer(buffer19);map.removeLayer(buffer20);
                                map.removeLayer(buffer21);map.removeLayer(buffer22);map.removeLayer(buffer23);
                            }
                            else if(this.x == 14)
                            {
                                map.addLayer(buffer14);map.removeLayer(buffer0);map.removeLayer(buffer1);map.removeLayer(buffer2);
                                map.removeLayer(buffer3);map.removeLayer(buffer4);map.removeLayer(buffer5);map.removeLayer(buffer6);map.removeLayer(buffer7);map.removeLayer(buffer8);map.removeLayer(buffer9);map.removeLayer(buffer10);map.removeLayer(buffer11);map.removeLayer(buffer12);map.removeLayer(buffer13);map.removeLayer(buffer15);map.removeLayer(buffer16);
                                map.removeLayer(buffer17);map.removeLayer(buffer18);map.removeLayer(buffer19);map.removeLayer(buffer20);
                                map.removeLayer(buffer21);map.removeLayer(buffer22);map.removeLayer(buffer23);
                            }
                            else if(this.x == 15)
                            {
                                map.addLayer(buffer15);map.removeLayer(buffer0);map.removeLayer(buffer1);map.removeLayer(buffer2);
                                map.removeLayer(buffer3);map.removeLayer(buffer4);map.removeLayer(buffer5);map.removeLayer(buffer6);map.removeLayer(buffer7);map.removeLayer(buffer8);map.removeLayer(buffer9);map.removeLayer(buffer10);map.removeLayer(buffer11);map.removeLayer(buffer12);map.removeLayer(buffer13);map.removeLayer(buffer14);map.removeLayer(buffer16);
                                map.removeLayer(buffer17);map.removeLayer(buffer18);map.removeLayer(buffer19);map.removeLayer(buffer20);
                                map.removeLayer(buffer21);map.removeLayer(buffer22);map.removeLayer(buffer23);
                            }
                            else if(this.x == 16)
                            {
                                map.addLayer(buffer16);map.removeLayer(buffer0);map.removeLayer(buffer1);map.removeLayer(buffer2);
                                map.removeLayer(buffer3);map.removeLayer(buffer4);map.removeLayer(buffer5);map.removeLayer(buffer6);map.removeLayer(buffer7);map.removeLayer(buffer8);map.removeLayer(buffer9);map.removeLayer(buffer10);map.removeLayer(buffer11);map.removeLayer(buffer12);map.removeLayer(buffer13);map.removeLayer(buffer14);map.removeLayer(buffer15);
                                map.removeLayer(buffer17);map.removeLayer(buffer18);map.removeLayer(buffer19);map.removeLayer(buffer20);
                                map.removeLayer(buffer21);map.removeLayer(buffer22);map.removeLayer(buffer23);
                            }
                            else if(this.x == 17)
                            {
                                map.addLayer(buffer17);map.removeLayer(buffer0);map.removeLayer(buffer1);map.removeLayer(buffer2);
                                map.removeLayer(buffer3);map.removeLayer(buffer4);map.removeLayer(buffer5);map.removeLayer(buffer6);map.removeLayer(buffer7);map.removeLayer(buffer8);map.removeLayer(buffer9);map.removeLayer(buffer10);map.removeLayer(buffer11);map.removeLayer(buffer12);map.removeLayer(buffer13);map.removeLayer(buffer14);map.removeLayer(buffer15);
                                map.removeLayer(buffer16);map.removeLayer(buffer18);map.removeLayer(buffer19);map.removeLayer(buffer20);
                                map.removeLayer(buffer21);map.removeLayer(buffer22);map.removeLayer(buffer23);
                            }
                            else if(this.x == 18)
                            {
                                map.addLayer(buffer18);map.removeLayer(buffer0);map.removeLayer(buffer1);map.removeLayer(buffer2);
                                map.removeLayer(buffer3);map.removeLayer(buffer4);map.removeLayer(buffer5);map.removeLayer(buffer6);map.removeLayer(buffer7);map.removeLayer(buffer8);map.removeLayer(buffer9);map.removeLayer(buffer10);map.removeLayer(buffer11);map.removeLayer(buffer12);map.removeLayer(buffer13);map.removeLayer(buffer14);map.removeLayer(buffer15);
                                map.removeLayer(buffer16);map.removeLayer(buffer17);map.removeLayer(buffer19);map.removeLayer(buffer20);
                                map.removeLayer(buffer21);map.removeLayer(buffer22);map.removeLayer(buffer23);
                            }
                            else if(this.x == 19)
                            {
                                map.addLayer(buffer19);map.removeLayer(buffer0);map.removeLayer(buffer1);map.removeLayer(buffer2);
                                map.removeLayer(buffer3);map.removeLayer(buffer4);map.removeLayer(buffer5);map.removeLayer(buffer6);map.removeLayer(buffer7);map.removeLayer(buffer8);map.removeLayer(buffer9);map.removeLayer(buffer10);map.removeLayer(buffer11);map.removeLayer(buffer12);map.removeLayer(buffer13);map.removeLayer(buffer14);map.removeLayer(buffer15);
                                map.removeLayer(buffer16);map.removeLayer(buffer17);map.removeLayer(buffer18);map.removeLayer(buffer20);
                                map.removeLayer(buffer21);map.removeLayer(buffer22);map.removeLayer(buffer23);
                            }
                            else if(this.x == 20)
                            {
                                map.addLayer(buffer20);map.removeLayer(buffer0);map.removeLayer(buffer1);map.removeLayer(buffer2);
                                map.removeLayer(buffer3);map.removeLayer(buffer4);map.removeLayer(buffer5);map.removeLayer(buffer6);map.removeLayer(buffer7);map.removeLayer(buffer8);map.removeLayer(buffer9);map.removeLayer(buffer10);map.removeLayer(buffer11);map.removeLayer(buffer12);map.removeLayer(buffer13);map.removeLayer(buffer14);map.removeLayer(buffer15);
                                map.removeLayer(buffer16);map.removeLayer(buffer17);map.removeLayer(buffer18);map.removeLayer(buffer19);
                                map.removeLayer(buffer21);map.removeLayer(buffer22);map.removeLayer(buffer23);
                            }
                            else if(this.x == 21)
                            {
                                map.addLayer(buffer21);map.removeLayer(buffer0);map.removeLayer(buffer1);map.removeLayer(buffer2);
                                map.removeLayer(buffer3);map.removeLayer(buffer4);map.removeLayer(buffer5);map.removeLayer(buffer6);map.removeLayer(buffer7);map.removeLayer(buffer8);map.removeLayer(buffer9);map.removeLayer(buffer10);map.removeLayer(buffer11);map.removeLayer(buffer12);map.removeLayer(buffer13);map.removeLayer(buffer14);map.removeLayer(buffer15);
                                map.removeLayer(buffer16);map.removeLayer(buffer17);map.removeLayer(buffer18);map.removeLayer(buffer19);
                                map.removeLayer(buffer20);map.removeLayer(buffer22);map.removeLayer(buffer23);
                            }
                            else if(this.x == 22)
                            {
                                map.addLayer(buffer22);map.removeLayer(buffer0);map.removeLayer(buffer1);map.removeLayer(buffer2);
                                map.removeLayer(buffer3);map.removeLayer(buffer4);map.removeLayer(buffer5);map.removeLayer(buffer6);map.removeLayer(buffer7);map.removeLayer(buffer8);map.removeLayer(buffer9);map.removeLayer(buffer10);map.removeLayer(buffer11);map.removeLayer(buffer12);map.removeLayer(buffer13);map.removeLayer(buffer14);map.removeLayer(buffer15);
                                map.removeLayer(buffer16);map.removeLayer(buffer17);map.removeLayer(buffer18);map.removeLayer(buffer19);
                                map.removeLayer(buffer20);map.removeLayer(buffer21);map.removeLayer(buffer23);
                            }
                            else if(this.x == 23)
                            {
                                map.addLayer(buffer23);map.removeLayer(buffer0);map.removeLayer(buffer1);map.removeLayer(buffer2);
                                map.removeLayer(buffer3);map.removeLayer(buffer4);map.removeLayer(buffer5);map.removeLayer(buffer6);map.removeLayer(buffer7);map.removeLayer(buffer8);map.removeLayer(buffer9);map.removeLayer(buffer10);map.removeLayer(buffer11);map.removeLayer(buffer12);map.removeLayer(buffer13);map.removeLayer(buffer14);map.removeLayer(buffer15);
                                map.removeLayer(buffer16);map.removeLayer(buffer17);map.removeLayer(buffer18);map.removeLayer(buffer19);
                                map.removeLayer(buffer20);map.removeLayer(buffer21);map.removeLayer(buffer22);
                            }





                            // showCurrentColor(layerArray,colorTable,this.x,map);
                        },
                        mouseOut: function () {
                            $(this.series.chart.xAxis[0].labelGroup.element.childNodes[this.x]).css({
                                    'fill': '#606060',
                                    'font-weight': 'normal',
                                    'font-size': '12px'
                            });
                            //this.x = 17
                            //console.log("mouseOut");
                            //createAllLayers(layerArray);
                        }
                    }
                }
            }
        }
    };
    $.getJSON('json/mel_ped_crash_count.json', function(data) {
        for (i = 0; i < data.length; i++){
            options.series[0].name = "Pedestrian Crash Count";
            options.series[0].type = "column";
            options.series[0].yAxis = 0;
            options.series[0].data.push({x:data[i].time_id, y:data[i].crash_count, time_period:data[i].time_period});
        }
        options.series.push({
            name: "Pedestrian Count",
            type: 'spline',
            yAxis: 1,
            data: [55,18,11,9,6,16,36,98,174,144,159,176,337,301,243,238,254,309,275,209,161,126,106,67]
        });
        $('#bar-chart').highcharts(options);
    });

});
</script>
<script>
    $(function () {
        var chart =  $('#sensor-chart').highcharts({
            credits:
            {
              enabled:false
            },
            title: {
                text: 'Monthly Average Temperature',
                x: -20 //center
            },
            subtitle: {
                text: 'Source: WorldClimate.com',
                x: -20
            },
            xAxis: {
                categories: ['0', '1', '2', '3', '4', '5',
                    '6', '7', '8', '9', '10', '11','12','13','14','15','16','17','18','19','20','21','22','23']
            },
            yAxis: {
                title: {
                    text: 'Pedestrian Counts'
                },
                plotLines: [{
                    value: 0,
                    width: 1,
                    color: '#808080'
                }]
            },
            plotOptions:
            {
                line:
                {
                    color:"#cccccc"
                },
                series:
                {
                    events:
                    {
                        mouseOver: function () {
                            this.graph.attr('stroke',"red");
                        },
                        mouseOut: function()
                        {
                            this.graph.attr('stroke',"#cccccc");
                        }
                    },
                    states:
                    {
                        hover:
                        {
                            enabled: true,
                            lineWidth: 5
                        }
                    },
                    marker:
                    {
                        enabled:false
                    },
                    point: {
                        events: {
                            mouseOver: function () {
                                $('.sensor').attr('fill',"white");
                                $('.'+this.series.name).attr("fill", "red");

                            }
                        }
                    }
                }
            },
            tooltip: {
                formatter: function () {
                    var prettyTime;
                    if(this.x == 0)
                    {
                        prettyTime = "00:00:00-01:00:00";
                    }
                    else if(this.x == 1)
                    {
                        prettyTime = "01:00:00-02:00:00";
                    }
                    else if(this.x == 2)
                    {
                        prettyTime = "02:00:00-03:00:00";
                    }else if(this.x == 3)
                    {
                        prettyTime = "03:00:00-04:00:00";
                    }else if(this.x == 4)
                    {
                        prettyTime = "04:00:00-05:00:00";
                    }else if(this.x == 5)
                    {
                        prettyTime = "05:00:00-06:00:00";
                    }else if(this.x == 6)
                    {
                        prettyTime = "06:00:00-07:00:00";
                    }else if(this.x == 7)
                    {
                        prettyTime = "07:00:00-08:00:00";
                    }else if(this.x == 8)
                    {
                        prettyTime = "08:00:00-09:00:00";
                    }else if(this.x == 9)
                    {
                        prettyTime = "09:00:00-10:00:00";
                    }else if(this.x == 10)
                    {
                        prettyTime = "10:00:00-11:00:00";
                    }else if(this.x == 11)
                    {
                        prettyTime = "11:00:00-12:00:00";
                    }else if(this.x == 12)
                    {
                        prettyTime = "12:00:00-13:00:00";
                    }
                    else if(this.x == 13)
                    {
                        prettyTime = "13:00:00-14:00:00";
                    }else if(this.x == 14)
                    {
                        prettyTime = "14:00:00-15:00:00";
                    }else if(this.x == 15)
                    {
                        prettyTime = "15:00:00-16:00:00";
                    }else if(this.x == 16)
                    {
                        prettyTime = "16:00:00-17:00:00";
                    }else if(this.x == 17)
                    {
                        prettyTime = "17:00:00-18:00:00";
                    }else if(this.x == 18)
                    {
                        prettyTime = "18:00:00-19:00:00";
                    }else if(this.x == 19)
                    {
                        prettyTime = "19:00:00-20:00:00";
                    }else if(this.x == 20)
                    {
                        prettyTime = "20:00:00-21:00:00";
                    }else if(this.x == 21)
                    {
                        prettyTime = "21:00:00-22:00:00";
                    }else if(this.x == 22)
                    {
                        prettyTime = "22:00:00-23:00:00";
                    }else if(this.x == 23)
                    {
                        prettyTime = "23:00:00-24:00:00";
                    }


                    return '<strong>'+prettyTime+'<br/></strong><strong>Pedestrian Count: '+this.y+'</strong>';
                }

            },
            legend: {
               enabled:false
            },
            series: [{
                id: 'sensorId1',
                sensor: '1',
                name:'sensorId1',
                data: [368,54,36,28,18,22,52,161,406,564,897,1325,2084,2331,1983,1908,1819,1744,1248,751,517,334,237,151]
            }, {
                id: 'sensorId2',
                sensor: '2',
                name:'sensorId2',
                data: [477,83,60,49,30,31,84,239,587,845,1374,2030,3146,3574,2969,2866,2693,2390,1453,822,581,392,291,200]
            }, {
                id: 'sensorId3',
                sensor: '3',
                name:'sensorId3',
                data: [735,216,134,96,51,66,138,284,609,729,980,1351,2174,2429,2262,2249,2249,2368,2236,1909,1698,1417,1060,730]
            }, {
                id: 'sensorId4',
                sensor: '4',
                name:'sensorId4',
                classname:'classid4',
                data: [946,272,186,141,90,91,163,406,878,1162,1683,2251,3181,3530,3206,3166,3090,3012,2389,1774,1464,1237,966,741]
            }, {
                id: 'sensorId5',
                sensor: '5',
                name:'sensorId5',
                data: [533,134,94,71,51,83,236,610,1156,881,1001,1269,1673,1709,1582,1603,1780,2185,1665,1228,925,910,876,535]
            }, {
                id: 'sensorId6',
                sensor: '6',
                name:'sensorId6',
                data: [632,138,89,62,56,107,350,938,2007,1161,918,1115,1733,1812,1523,1545,1857,2577,1676,1075,866,788,669,519]
            }, {
                id: 'sensorId7',
                sensor: '7',
                name:'sensorId7',
                data: [54,30,22,20,19,25,67,153,240,194,230,262,374,431,346,319,373,485,518,371,187,192,320,183]
            }, {
                id: 'sensorId8',
                sensor: '8',
                name:'sensorId8',
                data: [42,4,2,2,2,16,77,184,293,143,115,148,352,314,170,164,223,359,233,112,64,47,41,21]
            }, {
                id: 'sensorId9',
                sensor: '9',
                name:'sensorId9',
                data: [148,10,6,5,4,36,276,796,1604,757,319,312,731,653,381,466,935,1421,599,212,111,78,66,45]
            }, {
                id: 'sensorId10',
                sensor: '10',
                name:'sensorId10',
                data: [110,15,9,9,5,17,75,236,473,276,169,168,323,276,182,189,327,506,303,165,106,92,86,52]
            }, {
                id: 'sensorId11',
                sensor: '11',
                name:'sensorId11',
                data: [48,8,4,3,3,5,16,40,63,74,125,163,245,256,232,220,189,187,179,172,134,110,86,45]
            }, {
                id: 'sensorId12',
                sensor: '12',
                name:'sensorId12',
                data: [83,17,9,7,5,9,36,97,161,146,194,232,366,382,318,304,291,326,348,324,234,198,183,92]
            }, {
                id: 'sensorId13',
                sensor: '13',
                name:'sensorId13',
                data: [275,16,11,8,9,71,433,1475,3350,1609,659,566,791,879,643,824,1522,2390,1019,353,185,117,81,56]
            }, {
                id: 'sensorId14',
                sensor: '14',
                name:'sensorId14',
                data: [233,58,42,32,41,57,143,328,664,354,328,380,511,520,496,532,639,939,621,396,325,309,277,236]
            }, {
                id: 'sensorId15',
                sensor: '15',
                name:'sensorId15',
                data: [376,89,56,37,22,25,59,187,459,453,590,830,1327,1505,1370,1399,1454,1570,1207,934,797,603,423,277]
            }, {
                id: 'sensorId16',
                sensor: '16',
                name:'sensorId16',
                data: [299,41,29,22,15,21,69,260,600,692,934,1206,1833,1980,1484,1311,1168,1027,618,371,251,197,165,119]
            }, {
                id: 'sensorId17',
                sensor: '17',
                name:'sensorId17',
                data: [224,33,20,14,15,46,164,543,1262,792,525,544,1117,1098,640,551,633,971,635,360,263,186,166,118]
            }, {
                id: 'sensorId18',
                sensor: '18',
                name:'sensorId18',
                data: [159,17,12,8,6,25,141,536,1205,664,386,371,543,548,416,451,710,1074,526,220,126,96,87,62]
            }, {
                id: 'sensorId19',
                sensor: '19',
                name:'sensorId19',
                data: [51,34,19,11,6,5,9,20,45,55,98,160,269,283,250,233,228,260,281,270,236,184,137,82]
            }, {
                id: 'sensorId20',
                sensor: '20',
                name:'sensorId20',
                data: [56,36,24,16,9,5,7,16,33,44,75,117,200,191,145,128,126,163,211,231,197,158,135,89]
            }, {
                id: 'sensorId21',
                sensor: '21',
                name:'sensorId21',
                data: [101,81,62,52,34,22,28,39,66,75,107,159,288,289,233,230,240,274,269,254,228,197,172,132]
            }, {
                id: 'sensorId22',
                sensor: '22',
                name:'sensorId22',
                data: [103,48,34,25,19,40,124,307,527,405,454,546,721,753,717,745,823,902,688,507,414,348,279,193]
            }, {
                sensor: '23',
                id: 'sensorId23',
                name:'sensorId23',
                data: [13,7,5,4,3,9,33,100,184,114,94,95,136,128,95,96,117,137,83,52,40,36,32,23]
            }, {
                id: 'sensorId24',
                sensor: '24',
                name:'sensorId24',
                data: [27,10,7,5,7,38,144,387,612,357,286,288,407,370,313,385,563,659,370,206,133,108,90,60]
            }, {
                id: 'sensorId25',
                sensor: '25',
                name:'sensorId25',
                data: [27,14,6,4,4,14,50,109,164,125,138,168,230,235,231,238,254,293,199,114,85,73,66,43]
            }, {
                id: 'sensorId26',
                sensor: '26',
                name:'sensorId26',
                data: [33,25,17,13,10,17,36,74,135,179,239,307,432,399,304,238,182,163,142,124,107,86,64,46]
            }, {
                id: 'sensorId27',
                sensor: '27',
                name:'sensorId27',
                data: [8,5,3,2,2,3,9,23,43,46,59,69,84,79,66,57,45,50,44,35,32,27,20,13]
            }, {
                id: 'sensorId28',
                sensor: '28',
                name:'sensorId28',
                data: [33,20,14,13,14,28,76,183,317,242,270,334,419,424,393,407,441,500,395,295,176,199,182,73]
            }, {
                id: 'sensorId29',
                sensor: '29',
                name:'sensorId29',
                data: [18,11,7,4,5,15,29,69,121,92,112,146,192,211,197,201,199,248,216,154,113,92,76,45]
            }, {
                id: 'sensorId30',
                sensor: '30',
                name:'sensorId30',
                data: [73,54,39,30,21,14,17,34,62,68,97,138,231,225,176,167,171,191,197,189,170,148,129,101]
            }, {
                id: 'sensorId31',
                sensor: '31',
                name:'sensorId31',
                data: [42,20,9,4,5,3,7,21,41,43,61,75,124,138,126,131,118,134,160,193,216,203,151,89]
            }, {
                id: 'sensorId32',
                sensor: '32',
                name:'sensorId32',
                data: [74,43,27,18,12,14,32,93,205,179,220,294,418,459,428,426,447,539,444,347,295,266,222,141]
            }, {
                id: 'sensorId33',
                sensor: '33',
                name:'sensorId33',
                data: [3,1,1,1,1,3,11,29,54,35,25,26,38,36,28,30,45,52,30,17,11,10,11,6]
            }, {
                id: 'sensorId34',
                sensor: '34',
                name:'sensorId34',
                data: [6,3,2,1,1,3,9,18,31,25,25,28,43,41,33,31,37,46,35,26,20,18,21,13]
            }, {
                id: 'sensorId36',
                sensor: '36',
                name:'sensorId36',
                data: [5,4,3,2,1,1,2,7,21,16,16,16,27,27,18,17,18,25,15,11,7,7,6,6]
            }, {
                id: 'sensorId37',
                sensor: '37',
                name:'sensorId37',
                data: [2,1,0,0,0,0,0,2,5,6,7,8,15,15,12,11,10,11,13,16,17,14,9,5]
            }, {
                id: 'sensorId38',
                sensor: '38',
                name:'sensorId38',
                data: [58,31,22,18,15,18,31,70,137,127,149,184,227,248,237,243,254,273,232,182,152,136,122,99]
            }, {
                id: 'sensorId39',
                sensor: '39',
                name:'sensorId39',
                data: [4,2,2,1,1,2,8,20,42,35,30,32,69,62,32,25,28,36,28,20,14,13,11,7]
            }, {
                id: 'sensorId40',
                sensor: '40',
                name:'sensorId40',
                data: [3,2,1,1,0,1,2,8,24,21,23,22,38,37,24,25,22,24,19,17,12,10,12,6]
            }, {
                id: 'sensorId42',
                sensor: '42',
                name:'sensorId42',
                data: [0,0,0,0,0,0,0,1,3,3,3,4,5,5,4,4,4,5,4,3,2,1,1,1]
            }, {
                id: 'sensorId43',
                sensor: '43',
                name:'sensorId43',
                data: [0,0,0,0,0,0,0,1,3,4,3,4,4,4,4,4,5,5,4,2,2,1,1,0]
            }, {
                id: 'sensorId44',
                sensor: '44',
                name:'sensorId44',
                data: [0,0,0,0,0,0,0,1,1,2,2,2,2,2,2,2,2,2,2,1,1,1,0,0]
            }

            ]
        });

    });




    $('.sensor').mouseover(function()
    {
        var className = $(this).attr('class');

        $(this).attr('fill',"red");


        className =  className.replace(' ','');
        className =  className.replace(' ','');
        className =  className.replace('leaflet-clickable','');
        className =  className.replace('sensor','');

        var chart = $('#sensor-chart').highcharts(),
                series = chart.get(className);
        series.graph.attr('stroke',"red");
        series.graph.attr('stroke-width',5);
    });


    var table = ['sensorId1','sensorId2','sensorId3','sensorId4','sensorId5','sensorId6','sensorId7','sensorId8','sensorId9','sensorId10',
        'sensorId11','sensorId12','sensorId13','sensorId14','sensorId15','sensorId16','sensorId17','sensorId18','sensorId19','sensorId20',
        'sensorId21','sensorId22','sensorId23','sensorId24','sensorId25','sensorId26','sensorId27','sensorId28','sensorId29','sensorId30',
        'sensorId31','sensorId32','sensorId33','sensorId34','sensorId36','sensorId37','sensorId38','sensorId39','sensorId40','sensorId42',
        'sensorId43','sensorId44'];

    $('.sensor').mouseout(function()
    {

        $('.sensor').attr('fill',"white");

        for(var i=0; i<table.length;i++)
        {
            var className = table[i];
            var chart = $('#sensor-chart').highcharts(),
                    series = chart.get(className);
            series.graph.attr('stroke',"#cccccc");
        }



    });



</script>
</body>
</html>